                cell6.style.color = '#f39c12';
            } else {
                cell6.style.color = '#e74c3c';
            }
        }
        // Show summary
        const totalIncharges = Object.keys(attendanceStats).length;
        const averageAttendance = (
            Object.values(attendanceStats).reduce((sum, stats) => {
                const total = stats.present + stats.halfDay + stats.absent;
                const percentage = (stats.present + stats.halfDay) / total * 100;
                return sum + percentage;
            }, 0) / totalIncharges
        ).toFixed(2);
        summaryText.innerHTML = `
            Selected Month: <strong>${new Date(year, monthNum - 1).toLocaleString('default', { month: 'long', year: 'numeric' })}</strong><br>
            Total Records: <strong>${filteredRecords.length}</strong><br>
            Unique Incharges: <strong>${totalIncharges}</strong><br>
            Average Attendance: <strong>${averageAttendance}%</strong>
        `;
        
        summaryDiv.style.display = 'block';
        monthlyTable.style.display = 'table';
    });
    // Render any existing records on page load
    renderRecords();
</script>
</body>
</html>
